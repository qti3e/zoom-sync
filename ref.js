dre = [[18, 0, 0, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 28, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 56, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 84, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 112, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 140, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 160, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 188, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 216, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 0, 244, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 16, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 44, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 64, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 92, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 120, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 148, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 176, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 204, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 224, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 1, 252, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 2, 24, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 2, 52, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 2, 80, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [18, 2, 108, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
  , ure = [[20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [20, 3, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
  , fre = [[8, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [8, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [8, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [8, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

class HidStore {
  constructor() {
    this.device = null;
    this.version = null;
    this.keyDict = null;
    this.programProcess = null;
  }



  async requestDevice() {
    const e = await navigator.hid.requestDevice({
      filters: [
        {
          usagePage: 65376,
          usage: 97,
        },
      ],
    });
    this.device = e[0] || null;
    try {
      if (!this.device) return;
      await this.device.open(),
        (this.device.oninputreport = n => {
          const r = new Uint8Array(n.data.buffer),
            o = Ti();
          if (r[0] === 88 && r[2] == 0) this.programProcess = !1;
          else if (r[0] === 18) {
            const i = ((r[1] << 8) | r[2]) / 2,
              a = r[3],
              l = Math.floor(i / 80),
              s = i % 80;
            for (let d = 0; d < a / 2; d++) {
              const c = (r[4 + d * 2] << 8) | r[4 + d * 2 + 1];
              o.layers[l][s + d] = c;
            }
          } else
            r[0] === 1
              ? ((this.version = r[2]), (this.keyDict = Kx(this.version)))
              : r[0] === 20
                ? (o.knob[r[1]][r[3]] = (r[4] << 8) | r[5])
                : r[0] === 8 &&
                r[1] === 3 &&
                (r[2] === 1
                  ? (o.brightnessValue = r[3])
                  : r[2] === 2
                    ? (o.effectValue = r[3].toString())
                    : r[2] === 3
                      ? (o.effectSpeedValue = r[3])
                      : r[2] === 4 && (o.colorValue = gre(r[3], r[4])));
        });
      const t = new Uint8Array(32);
      (t[0] = 1), await this.device.sendReport(0, t);
      for (const n of dre) await this.device.sendReport(0, new Uint8Array(n));
      for (const n of ure) await this.device.sendReport(0, new Uint8Array(n));
      for (const n of fre) await this.device.sendReport(0, new Uint8Array(n));
    } catch (t) {
      console.log(t);
    }
  }

  async closeDevice() {
    try {
      if (!this.device) return;
      await this.device.close();
      await this.device.forget();
      this.device = null;
    } catch (e) {
      console.log(e);
    }
  }
}

const d = new HidStore();
await d.requestDevice();

const O = async (le, Ce) => {
  if (v.value) return;
  v.value = !0;
  const De = new Uint8Array(32);
  De[0] = 88;
  De[1] = Ce;
  De.set(le, 2);
  console.log(De);
  try {
    await d.device.sendReport(0, De);
  } catch (F) {
    console.error('Send failed:', F);
  }
};

const q = async () => {
  let le = new Date();
  let Ce = new Uint8Array(9);
  Ce[0] = 165;
  Ce[1] = 1;
  Ce[2] = 16;
  Ce[3] = le.getFullYear() - 2e3;
  Ce[4] = le.getMonth() + 1;
  Ce[5] = le.getDate();
  Ce[6] = le.getHours();
  Ce[7] = le.getMinutes();
  Ce[8] = le.getSeconds();
  await O(Ce, 9);
};


K = async () => {
  navigator.geolocation ? navigator.geolocation.getCurrentPosition(le => Y(qae, le), function() {
    t.error(st[p.local].noLocationPermision, {
      duration: 4e3
    })
  }) : t.error(st[p.local].browserNotSupport, {
    duration: 4e3
  })
}

Y = async (coords) => {

  let De = (await hr.get("https://weather.meletrix.cn/v1/forecast.json?q=" + coords.coords.latitude + "," + coords.coords.longitude)).data, F = De.current.temp_c, G;
  F > 0 ? G = F | 0 : G = -F | 32768;
  let ue = De.forecast.forecastday[0].day.mintemp_c, xe;
  ue > 0 ? xe = ue | 0 : xe = -ue | 32768;
  let ne = De.forecast.forecastday[0].day.maxtemp_c, oe;
  ne > 0 ? oe = ne | 0 : oe = -ne | 32768;
  let we = new Date, te;
  switch (De.current.condition.code) {
    case 1e3:
      te = we.getHours() > 18 ? 4 : 0;
      break;
    case 1003:
      te = we.getHours() > 18 ? 3 : 1;
      break;
    case 1006:
    case 1009:
    case 1030:
    case 1135:
    case 1147:
      te = 5;
      break;
    case 1063:
    case 1072:
    case 1150:
    case 1153:
    case 1168:
    case 1171:
    case 1180:
    case 1183:
    case 1186:
    case 1189:
    case 1192:
    case 1195:
    case 1198:
    case 1201:
    case 1240:
    case 1243:
    case 1246:
      te = 6;
      break;
    case 1066:
    case 1069:
    case 1114:
    case 1117:
    case 1204:
    case 1207:
    case 1210:
    case 1213:
    case 1216:
    case 1219:
    case 1222:
    case 1225:
    case 1249:
    case 1252:
    case 1255:
    case 1258:
    case 1279:
    case 1282:
      te = 7;
      break;
    case 1087:
    case 1273:
    case 1276:
      te = 8;
      break;
    default:
      te = 0;
      break
  }
  const ce = new Uint8Array(7);
  ce[0] = 165,
    ce[1] = 1,
    ce[2] = 32,
    ce[3] = te,
    ce[4] = G,
    ce[5] = xe,
    ce[6] = oe,
    await O(ce, 7),
    t.success(st[p.local].updateWeatherSuccess, {
      duration: 2e3
    });
}
